<ion-view view-title="Trackbus">
    <!--INSERT CSS HERE-->
    <ion-content class="has-header">
        <body>
            <div id="map-div" class="map-container">
                <ui-gmap-google-map center="vm.map.center" zoom="vm.map.zoom" control="vm.map">
                    <!-- User marker -->
                    <ui-gmap-marker coords="vm.userMarker.coords" options="vm.userMarker.options"
                        events="vm.userMarker.events" idkey="'user'"
                        click="vm.userMarker.click">
                    </ui-gmap-marker>
                    <!-- User marker -->

                    <!-- Bus stops -->
                    <div ng-repeat="marker in vm.stopsMarkers">
                        <ui-gmap-marker
                            coords="marker.coords" options="marker.options"
                            events="marker.events" idkey="marker.id"
                            click="marker.click">
                            <!-- Window content -->
                            <ui-gmap-window>
                                <div>
                                    {{::marker.description}}
                                    <br>
                                    <button class="button button-small button-assertive"
                                        ng-click="$parent.vm.addStopProximityListener($parent.marker, true)">
                                        Notificar proximidade
                                    </button>
                                </div>
                            </ui-gmap-window>
                        </ui-gmap-marker>
                    </div>
                    <!-- Bus stops -->

                    <!-- Tourist stops -->
                    <div ng-repeat="marker in vm.touristMarkers">
                        <ui-gmap-marker
                            coords="marker.coords" options="marker.options"
                            events="marker.events" idkey="marker.id"
                            click="marker.click">
                            <!-- Window content -->
                            <ui-gmap-window>
                                <div>
                                    {{::marker.id}}
                                    <br>
                                    {{::marker.address}}
                                    <br>
                                    <button class="button button-small button-assertive"
                                        ng-click="$parent.vm.addTouristProximityListener($parent.marker, true)">
                                        Notificar proximidade
                                    </button>
                                </div>
                            </ui-gmap-window>
                        </ui-gmap-marker>
                    </div>
                    <!-- Tourist stops -->
                </ui-gmap-google-map>
            </div>

            <div class="button-bar">
                <a class="button" ng-click="showStops=true">Pontos de parada</a>
                <a class="button" ng-click="showStops=false">Pontos turísticos</a>
            </div>

            <!--Pontos de parada-->
            <div ng-show="showStops" ng-init="showStops=true">
                <div ng-repeat="stop in vm.stops">
                    <div ng-click="vm.setPosition({latitude: stop.latitude, longitude: stop.longitude})">
                       {{::stop.descricao_ponto}}
                    </div>
                    <ion-toggle ng-model="stop.selected" toggle-class="toggle-calm"
                        ng-selected="stop.selected"
                        ng-change="vm.toggleStopProximityListener(stop)">
                    </ion-toggle>
                </div>
            </div>
            <!--Pontos de parada-->

            <!-- Pontos turísticos -->
            <div ng-show="!showStops">
                <div ng-repeat="ts in vm.touristSpots">
                    <div ng-click="vm.setPosition({latitude: ts.latitude, longitude: ts.longitude})">
                       {{::ts.nome}}
                    </div>
                    <ion-toggle ng-model="ts.selected" toggle-class="toggle-calm"
                        ng-selected="ts.selected"
                        ng-change="vm.toggleTouristProximityListener(ts)">
                    </ion-toggle>
                </div>
            </div>
            <!-- Pontos turísticos -->
        </body>
    </ion-content>
</ion-view>
